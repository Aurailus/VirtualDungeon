const wallField = [
	33, 33, 6,  6,  33, 33, 6,  6,  5,  5,  10, 17, 5,  5,  10, 17, 15, 15, 9,  9,  15, 15, 16, 16, 2,  2,  4,  50, 2,  2,  49, 32,
	33, 33, 6,  6,  33, 33, 6,  6,  5,  5,  10, 17, 5,  5,  10, 17, 15, 15, 9,  9,  15, 15, 16, 16, 2,  2,  4,  50, 2,  2,  49, 32,
	14, 14, 11, 11, 14, 14, 11, 11, 1,  1,  13, 48, 1,  1,  13, 48, 0,  0,  12, 12, 0,  0,  47, 47, 3,  3,  25, 46, 3,  3,  45, 20,
	14, 14, 11, 11, 14, 14, 11, 11, 8,  8,  39, 23, 8,  8,  39, 23, 0,  0,  12, 12, 0,  0,  47, 47, 41, 41, 37, 29, 41, 41, 51, 18,
	33, 33, 6,  6,  33, 33, 6,  6,  5,  5,  10, 17, 5,  5,  10, 17, 15, 15, 9,  9,  15, 15, 16, 16, 2,  2,  4,  50, 2,  2,  49, 32,
	33, 33, 6,  6,  33, 33, 6,  6,  5,  5,  10, 17, 5,  5,  10, 17, 15, 15, 9,  9,  15, 15, 16, 16, 2,  2,  4,  50, 2,  2,  49, 32,
	14, 14, 11, 11, 14, 14, 11, 11, 1,  1,  13, 48, 1,  1,  13, 48, 7,  7,  38, 38, 7,  7,  22, 22, 40, 40, 36, 42, 40, 40, 30, 19,
	14, 14, 11, 11, 14, 14, 11, 11, 8,  8,  39, 23, 8,  8,  39, 23, 7,  7,  38, 38, 7,  7,  22, 22, 31, 31, 21, 27, 31, 31, 28, 54
];

const floorField = [
	54, 20, 19, 19, 18, 4,  19, 19, 11, 11, 3,  3,  51, 51, 3,  3,  9,  52, 5,  5,  9,  52, 5,  5,  39, 39, 30, 30, 39, 39, 30, 30,
	2,  12, 32, 32, 34, 6,  32, 32, 11, 11, 3,  3,  51, 51, 3,  3,  43, 38, 29, 29, 43, 38, 29, 29, 39, 39, 30, 30, 39, 39, 30, 30,
	1,  41, 17, 17, 40, 46, 17, 17, 21, 21, 8,  8,  45, 45, 8,  8,  23, 47, 26, 26, 23, 47, 26, 26, 48, 48, 49, 49, 48, 48, 49, 49,
	1,  41, 17, 17, 40, 46, 17, 17, 21, 21, 8,  8,  45, 45, 8,  8,  23, 47, 26, 26, 23, 47, 26, 26, 48, 48, 49, 49, 48, 48, 49, 49,
	0,  33, 31, 31, 14, 7,  31, 31, 42, 42, 27, 27, 36, 36, 27, 27, 9,  52, 5,  5,  9,  52, 5,  5,  39, 39, 30, 30, 39, 39, 30, 30,
	22, 15, 28, 28, 16, 37, 28, 28, 42, 42, 27, 27, 36, 36, 27, 27, 43, 38, 29, 29, 43, 38, 29, 29, 39, 39, 30, 30, 39, 39, 30, 30,
	1,  41, 17, 17, 40, 46, 17, 17, 21, 21, 8,  8,  45, 45, 8,  8,  23, 47, 26, 26, 23, 47, 26, 26, 48, 48, 49, 49, 48, 48, 49, 49,
	1,  41, 17, 17, 40, 46, 17, 17, 21, 21, 8,  8,  45, 45, 8,  8,  23, 47, 26, 26, 23, 47, 26, 26, 48, 48, 49, 49, 48, 48, 49, 49
];

export function bitsToIndices(walls: boolean[]) {
	return (
		(+walls[0] << 0) +
		(+walls[1] << 1) +
		(+walls[2] << 2) +
		(+walls[3] << 3) +
		(+walls[5] << 4) +
		(+walls[6] << 5) +
		(+walls[7] << 6) +
		(+walls[8] << 7));
}

export function wall(walls: boolean[], current: number): number {
	if (current === -1) return -1;
	const ind = wallField[bitsToIndices(walls)];
	if (ind < 54) return ind;
	return 54 + Math.floor(Math.random() * 6);
}

export function overlay(overlays: boolean[], current: number): number {
	if (current === -1) return -1;
	const ind = floorField[bitsToIndices(overlays)];
	if (ind < 54) return ind;
	return 54 + Math.floor(Math.random() * 6);
}

export function floor(walls: boolean[], current: number): number {
	if (current === -1) return -1;
	const ind = floorField[bitsToIndices(walls)];
	if (ind < 54) return ind;
	return 54 + Math.floor(Math.random() * 6);
}

// const l = [];
// for (let i = 0; i < (1 << 8); ++i ) {
//   let arr = [ i & 0x001, i & 0x002, i & 0x004, i & 0x008, 0,
//   						i & 0x010, i & 0x020, i & 0x040, i & 0x080 ].map(a => !!a);
// 	l.push(overlay(arr, 1));
// }

// let lines = [];
// for (let i = 0; i < 16; i++) {
// 	lines.push(l.slice(i * 16, (i + 1) * 16).map(n => n < 10 ? n + ', ' : n + ',').join(' '));
// }

// console.log(lines.join('\n'));
